version: 1
send_anonymous_usage_stats: false
plugins:
  extractors:
    - name: tap-rest-api-msdk
      namespace: tap_rest_api_msdk
      # executable: ./tap-rest-api-msdk.sh
      pip_url: .
      capabilities:
        - state
        - catalog
        - discover
      settings:
        - name: name
          kind: string
        - name: schema
          kind: string
        - name: schemas
          kind: object
        - name: common_parameters_list
          kind: array
        - name: common_parameters
          kind: object
        - name: api_url
          kind: string
        - name: path
          kind: string
        - name: params
          kind: object
        - name: headers
          kind: object
        - name: records_path
          kind: string
        - name: primary_keys
          kind: array
        - name: except_keys
          kind: array
        - name: pagination_request_style
        - name: pagination_response_style
        - name: pagination_page_size
          kind: integer
        - name: streams
          kind: array
        - name: streams_auth
          kind: array
      config:
        common_parameters:
          us_earthquakes:
            api_url: https://earthquake.usgs.gov/fdsnws
            path: /event/1/query
            params:
              format: geojson
              starttime: "2014-01-01"
              endtime: "2014-01-02"
              minmagnitude: 1
            primary_keys:
              - id
            records_path: "$.features[*]"
            num_inference_records: 100
            select:
              - "*.*"
        schemas:
          us_earthquakes:
            properties:
              geometry_coordinates:
                type: string
              geometry_type:
                type: string
              id:
                type: string
              properties_alert:
                type:
                  - "null"
                  - string
              properties_cdi:
                type:
                  - "null"
                  - number
              properties_code:
                type: string
              properties_detail:
                type: string
              properties_dmin:
                type:
                  - "null"
                  - number
              properties_felt:
                type:
                  - integer
                  - "null"
              properties_gap:
                type:
                  - "null"
                  - number
              properties_ids:
                type: string
              properties_mag:
                type: number
              properties_magType:
                type: string
              properties_mmi:
                type:
                  - "null"
                  - number
              properties_net:
                type: string
              properties_nst:
                type:
                  - integer
                  - "null"
              properties_place:
                type: string
              properties_rms:
                type: number
              properties_sig:
                type: integer
              properties_sources:
                type: string
              properties_status:
                type: string
              properties_time:
                type: integer
              properties_title:
                type: string
              properties_tsunami:
                type: integer
              properties_type:
                type: string
              properties_types:
                type: string
              properties_tz:
                type: "null"
              properties_updated:
                type: integer
              properties_url:
                type: string
              type:
                type: string
            type: object
        #   name: us_earthquakes
        #   api_url: https://earthquake.usgs.gov/fdsnws
        #   path: /event/1/query
        #   params:
        #     format: geojson
        #     starttime: "2014-01-01"
        #     endtime: "2014-01-02"
        #     minmagnitude: 1
        #   primary_keys:
        #     - id
        #   records_path: "$.features[*]"
        #   num_inference_records: 100
        #   select:
        #     - "*.*"
        streams:
          - name: us_earthquakes1
            schema: us_earthquakes
            common_parameters_list:
              - us_earthquakes
          - name: us_earthquakes2
            schema: us_earthquakes
            common_parameters_list:
              - us_earthquakes
      # If you need auth, put it in a list of objects
      # matched with the name of the stream names
      # steams_auth:
      #   - match_type: exact
      #     name: us_earthquakes
      #     headers:
      #       "X-ApiKeys": "my secret api keys"
      #   - match_type: prefix
      #     name: us_
      #     headers:
      #       "X-ApiKeys": "my secret api keys"
      #   - match_type: suffix
      #     name: earthquakes
      #     headers:
      #       "X-ApiKeys": "my secret api keys"
      #   - match_type: regex
      #     name: "^.*earth.*$"
      #     headers:
      #       "X-ApiKeys": "my secret api keys"
  loaders:
    - name: target-jsonl
      variant: andyh1203
      pip_url: target-jsonl
